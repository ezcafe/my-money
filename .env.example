# My Money Application - Environment Variables Example
# Copy this file to .env and fill in the actual values
# DO NOT commit .env to version control

# ============================================
# Backend Configuration
# ============================================

# Database Configuration
# PostgreSQL connection string. Format: postgresql://user:password@host:port/database?connection_limit=100&pool_timeout=20&connect_timeout=10
# DEVELOPMENT: Use 'postgres' as host (Docker service name); app converts to localhost when running outside Docker.
# PRODUCTION: Use your DB host and include connection pooling params in the URL.
# MUST MATCH: If using backend/.env separately, DATABASE_URL should be the same as in root .env.
DATABASE_URL=postgresql://postgres:postgres@postgres:5432/mymoney?connection_limit=100&pool_timeout=20&connect_timeout=10

# Server port for the GraphQL API.
# DEVELOPMENT: Typically 4000. Can change if port is in use.
# PRODUCTION: Often not used directly (reverse proxy handles ports); used with Cloudflare Tunnel.
PORT=4000

# Runtime environment.
# DEVELOPMENT: Use "development".
# PRODUCTION: Use "production".
NODE_ENV=production

# Schedule Configuration
# When true, enables hourly and minutely recurring transaction schedules (default: false).
# MUST MATCH: Same value as REACT_APP_ENABLE_HOURLY_MINUTELY_SCHEDULES in frontend.
ENABLE_HOURLY_MINUTELY_SCHEDULES=false

# OIDC Authentication (Pocket ID or other OIDC provider)
# Required for authentication. Server may not start without these in production.
# MUST MATCH: OPENID_CLIENT_ID and OPENID_DISCOVERY_URL must match REACT_APP_OPENID_CLIENT_ID and REACT_APP_OPENID_DISCOVERY_URL in frontend.
OPENID_CLIENT_ID=your-client-id
OPENID_CLIENT_SECRET=your-client-secret
OPENID_DISCOVERY_URL=https://your-oidc-provider/.well-known/openid-configuration

# CORS allowed origins (comma-separated).
# Backend allows requests from these origins. Must include your frontend URL.
# PRODUCTION: Use your actual frontend domain(s), e.g. https://app.example.com.
# DEVELOPMENT: Use http://localhost:FRONTEND_PORT and http://127.0.0.1:FRONTEND_PORT (match FRONTEND_PORT below).
# MUST MATCH: Must allow the same origin as FRONTEND_URL; ALLOWED_ORIGINS should list the same frontend origin(s).
CORS_ORIGIN=http://localhost:3000,http://127.0.0.1:3000

# Backend and Frontend base URLs (used for OAuth redirect_uri and links).
# PRODUCTION: Must be your real HTTPS URLs. OAuth providers validate redirect_uri against these.
#   Single-domain: set both to same URL (e.g. https://app.example.com); frontend nginx proxies API.
#   Split-domain: e.g. BACKEND_URL=https://api.example.com, FRONTEND_URL=https://app.example.com
# DEVELOPMENT: Use http://localhost:BACKEND_PORT and http://localhost:FRONTEND_PORT (match BACKEND_PORT, FRONTEND_PORT below).
# MUST MATCH: FRONTEND_URL must match where the frontend is served; REACT_APP_GRAPHQL_URL in frontend must point to backend (BACKEND_URL/graphql).
BACKEND_URL=http://localhost:4000
FRONTEND_URL=http://localhost:3000

# CSRF allowed origins (comma-separated).
# Origins allowed for CSRF validation on mutations. Should match frontend origin(s).
# PRODUCTION: Your frontend domain(s), e.g. https://app.example.com.
# DEVELOPMENT: Same as CORS_ORIGIN / FRONTEND_URL origin (e.g. http://localhost:3000, http://127.0.0.1:3000).
# MUST MATCH: Should match CORS_ORIGIN and FRONTEND_URL origin.
ALLOWED_ORIGINS=https://your-production-domain.com

# Cookie and HTTPS (auth session persistence).
# Backend uses these to set Secure and SameSite on auth cookies. When behind a proxy (e.g. Cloudflare), the backend may see HTTP; set these so cookies are Secure and session persists.
# COOKIE_SECURE: When true, auth cookies are set with Secure flag (HTTPS only). PRODUCTION: true. DEVELOPMENT (localhost HTTP): false or omit.
# USE_HTTPS: When true, same as COOKIE_SECURE for cookie logic; also used for SameSite=Strict. PRODUCTION (Cloudflare/reverse proxy): true. DEVELOPMENT: false or omit.
COOKIE_SECURE=false
USE_HTTPS=false

# ============================================
# Frontend Configuration
# ============================================
# Frontend vars are prefixed with REACT_APP_ and injected at build time.

# GraphQL API endpoint URL (used by the browser).
# PRODUCTION: Split-domain: https://api.example.com/graphql; Single-domain: https://app.example.com/graphql.
# DEVELOPMENT: http://localhost:BACKEND_PORT/graphql (match BACKEND_PORT).
# MUST MATCH: Must point to the same backend as BACKEND_URL; backend PORT (or URL) must align with BACKEND_PORT/BACKEND_URL.
REACT_APP_GRAPHQL_URL=http://localhost:4000/graphql

# WebSocket GraphQL URL (optional). If unset, derived from REACT_APP_GRAPHQL_URL.
# Single-domain: set to wss://app.example.com/graphql-ws when using one hostname.
# REACT_APP_WS_GRAPHQL_URL=wss://app.example.com/graphql-ws

# OIDC client ID (frontend). Used for client-side OIDC flows.
# MUST MATCH: Same value as OPENID_CLIENT_ID in backend.
REACT_APP_OPENID_CLIENT_ID=your-client-id

# OIDC discovery URL (frontend).
# MUST MATCH: Same value as OPENID_DISCOVERY_URL in backend.
REACT_APP_OPENID_DISCOVERY_URL=https://your-oidc-provider/.well-known/openid-configuration

# OIDC client secret (optional). Only if your OIDC provider requires it for public clients.
# REACT_APP_OPENID_CLIENT_SECRET=

# Schedule Configuration (Frontend)
# When true, shows hourly/minutely schedule options (default: false).
# MUST MATCH: Same value as ENABLE_HOURLY_MINUTELY_SCHEDULES in backend.
REACT_APP_ENABLE_HOURLY_MINUTELY_SCHEDULES=false

# ============================================
# Docker / Compose Configuration
# ============================================

# Host ports exposed by docker-compose for backend and frontend.
# DEVELOPMENT: Change if 3000/4000 are in use; then update BACKEND_URL, FRONTEND_URL, REACT_APP_GRAPHQL_URL, CORS_ORIGIN to use these ports.
# PRODUCTION (Direct/Reverse Proxy): Usually not used (proxy handles ports).
# PRODUCTION (Cloudflare Tunnel): Used; tunnel connects to localhost:BACKEND_PORT and localhost:FRONTEND_PORT. Keep BACKEND_URL, FRONTEND_URL, REACT_APP_GRAPHQL_URL, CORS_ORIGIN as production HTTPS URLs.
BACKEND_PORT=4000
FRONTEND_PORT=3000

# PostgreSQL container settings (used by docker-compose postgres service and to build DATABASE_URL if needed).
# No need to match other env files unless you construct DATABASE_URL from these.
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres
POSTGRES_DB=mymoney
POSTGRES_HOST=postgres
POSTGRES_PORT=5432

# Build metadata (optional, used in Docker builds).
# PRODUCTION / CI: Often set in CI; not required for local development.
BUILD_DATE=
VCS_REF=
VERSION=1.0.0
NODE_VERSION=25.2.1
NGINX_VERSION=alpine
